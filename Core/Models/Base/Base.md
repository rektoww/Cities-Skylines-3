# Документация по базовым моделям (Base Models)

Этот документ описывает абстрактные базовые классы, которые служат основой для большинства игровых объектов в симуляции.

## Глава 1: GameObject.cs

`GameObject` - это фундаментальный абстрактный класс для любого объекта, существующего в игровом мире. Он предоставляет базовые свойства, такие как идентификатор и позиция.

### Свойства

- **`Id`**: `int` (только для чтения) - Уникальный идентификатор объекта, который генерируется автоматически.
- **`Name`**: `string` - Имя объекта.
- **`X`**, **`Y`**: `int` - Координаты объекта на игровой карте.
- **`IsActive`**: `bool` - Флаг, указывающий, активен ли объект.
- **`Position`**: `(int X, int Y)` - Кортеж для удобного получения и установки координат.

## Глава 2: Building.cs

`Building` - это абстрактный класс, наследуемый от `GameObject`. Он служит базой для всех зданий в игре и определяет общие свойства, логику размещения на карте и требования для строительства.

### Свойства экземпляра

- **`Floors`**: `int` - Количество этажей в здании.
- **`Condition`**: `float` - Состояние здания (от 100.0 - идеально, до 0.0 - разрушено).
- **`Width`**, **`Height`**: `int` - Размеры здания в тайлах.
- **`MaxOccupancy`**, **`CurrentOccupancy`**: `int` - Максимальная и текущая вместимость.
- **`GameMap`**: `GameMap` - Ссылка на игровую карту.

### Свойства системы ЖКХ

- **`HasElectricity`**, **`HasWater`**, **`HasGas`**, **`HasSewage`**: `bool` - Флаги подключения к коммунальным сетям.
- **`IsOperational`**: `bool` (только для чтения) - Работоспособно ли здание (требуются все коммуникации).

### Методы

- **`TryPlace(int x, int y, GameMap map)`**: `bool` - Пытается разместить здание на координатах.
- **`OnBuildingPlaced()`**: `abstract void` - Вызывается после успешного размещения.
- **`CanPlace(int x, int y, GameMap map)`**: `virtual bool` - Проверяет, можно ли разместить здание.

## Глава 3: Mob.cs

`Mob` (Mobile Object) - это абстрактный класс на базе `GameObject` для всех подвижных объектов (горожане, транспорт).

### Свойства

- **`GameMap`**: `GameMap` - Ссылка на игровую карту.

### Методы

- **`Move()`**: `abstract void` - Абстрактный метод для реализации логики передвижения.
- **`MoveTo(int toX, int toY)`**: `protected bool` - Пытается переместить моба.
- **`CanMoveTo(int toX, int toY)`**: `protected bool` - Проверяет, может ли моб переместиться.

## Глава 4: Transport.cs

`Transport` — это абстрактный класс, наследуемый от `Mob`. Он служит базой для всех движущихся транспортных средств и содержит общую логику для перевозки пассажиров.

### Свойства

- **`MaxCapacity`**: `int` - Максимальное количество пассажиров.
- **`Passengers`**: `List<Citizen>` - Список текущих пассажиров.
- **`Speed`**: `float` - Скорость движения.
- **`CanAcceptPassenger`**: `bool` - Флаг, показывающий, есть ли свободные места.

### Методы

- **`TryBoard(Citizen citizen)`**: `virtual bool` - Логика посадки пассажира.
- **`TryDisembark(Citizen citizen)`**: `virtual bool` - Логика высадки пассажира.

## Глава 5: PublicTransport.cs

`PublicTransport` — абстрактный класс на базе `Transport`. Он вводит логику движения по фиксированным маршрутам и является основой для `Bus`, `Tram` и т.д.

### Свойства

- **`Route`**: `List<Tile>` - Последовательность тайлов маршрута.
- **`NextWaypointIndex`**: `int` - Индекс следующей точки в маршруте.

## Глава 6: TransitStation.cs

`TransitStation` — это абстрактный класс на базе `Building`. Является основой для всех точек посадки и высадки пассажиров (автобусные остановки, вокзалы).

### Свойства

- **`WaitingCitizens`**: `List<Citizen>` - Список граждан, ожидающих транспорт.
- **`ServicedRoutes`**: `List<PublicTransport>` - Список маршрутов, проходящих через эту станцию.

### Методы

- **`AddWaitingCitizen(Citizen citizen)`**: `void` - Добавляет гражданина в список ожидания.
- **`RemoveWaitingCitizen(Citizen citizen)`**: `bool` - Удаляет гражданина из списка ожидания.

## Глава 7: DisasterEvent.cs

`DisasterEvent` — это класс, наследуемый от `GameObject`, который представляет событие бедствия на карте. Обрабатывает применение эффектов и распространение бедствия.

### Свойства

- **`Type`**: `DisasterType` - Тип бедствия.
- **`Intensity`**: `float` - Интенсивность бедствия.
- **`DurationTicks`**: `int` - Длительность бедствия в тактах.
- **`CurrentTick`**: `int` - Текущий такт бедствия.
- **`IsActive`**: `bool` (только для чтения) - Флаг активности бедствия.
- **`EpicenterX`**, **`EpicenterY`**: `int` - Координаты эпицентра бедствия.
- **`Radius`**: `float` - Радиус воздействия бедствия.
- **`Map`**: `GameMap` - Игровая карта для применения эффектов.
- **`Manager`**: `DisasterManager` - Менеджер бедствий для координации событий.

### События

- **`OnFireSpread`**: `Action<DisasterEvent>` - Возникает при распространении пожара.

### Методы

- **`Update()`**: `void` - Обновление состояния бедствия, применяет эффекты и обрабатывает распространение.
- **`AffectTile(Tile tile, float localIntensity)`**: `void` - Воздействие на указанный тайл с заданной интенсивностью.


## Глава 8: CommercialTransport.cs

`CommercialTransport` — это абстрактный класс, наследуемый от `Transport`. Он предназначен для всех видов коммерческого транспорта (самолёты, корабли, грузовики), перевозящих **ресурсы и товары**, а не пассажиров. Определяет общую структуру и поведение таких объектов.

### Свойства

* **`Cargo`**: `Dictionary<TransportedGoods, int>` — Словарь перевозимых ресурсов, где ключом выступает тип груза, а значением — количество единиц.
* **`TotalCargoAmount`**: `int` (только для чтения) — Общее количество загруженных товаров.
* **`CanAcceptCargo`**: `bool` (только для чтения) — Флаг, показывающий, есть ли свободное место для загрузки дополнительных товаров.
* **`Route`**: `List<Tile>` — Последовательность тайлов, составляющих маршрут коммерческого транспорта.

### Методы

* **`LoadCargo(TransportedGoods material, int amount)`**: `virtual bool` — Пытается загрузить указанное количество ресурса. Возвращает `true`, если загрузка прошла успешно.
* **`GetCargoAmount(TransportedGoods material)`**: `int` — Возвращает количество конкретного ресурса на борту.
* **`CanLoadAmount(int amount)`**: `bool` — Проверяет, достаточно ли места для загрузки указанного количества товаров.
* **`GetCargoTypes()`**: `List<TransportedGoods>` — Возвращает список типов ресурсов, находящихся в трюме.



## Глава 9: Port.cs

`Port` — абстрактный класс, наследуемый от `TransitStation`. Представляет **порт прибытия и отправления коммерческого транспорта** (морского или воздушного). Обеспечивает управление вместимостью и обработку прибывших судов и самолётов.

### Свойства

* **`Capacity`**: `int` — Максимальное количество транспортов, которые может одновременно принять порт.
* **`CurrentTransports`**: `int` — Текущее число транспортов, находящихся в порту.
* **`ArrivedTransports`**: `List<CommercialTransport>` — Список всех коммерческих транспортов, успешно прибывших в порт.

### Методы

* **`CanAcceptTransport()`**: `virtual bool` — Проверяет, есть ли свободные места для приёма нового транспорта.
* **`AddTransport()`**: `virtual void` — Увеличивает счётчик прибывших транспортов, если есть свободные слоты.
* **`RemoveTransport()`**: `virtual void` — Уменьшает счётчик при удалении транспорта из порта.
* **`ReceiveTransport(CommercialTransport transport)`**: `virtual void` — Обрабатывает прибытие транспорта, проверяет достижение конечной точки и наличие свободного места, добавляет транспорт в список `ArrivedTransports` и вызывает метод `HideTransport()`.
* **`HideTransport(CommercialTransport transport)`**: `abstract void` — Абстрактный метод-заглушка для реализации скрытия транспорта, достигшего порта (например, снятие с карты или отключение визуализации).
* **`DeleteTransport(CommercialTransport transport)`**: `abstract void` — Абстрактный метод для удаления транспорта из активных объектов (например, из коллекции мобов на карте).
* **`GetAvailableSlots()`**: `virtual int` — Возвращает количество свободных слотов для приёма новых транспортов.




