# Документация по сервисам (Services)

Этот документ описывает сервисные классы, отвечающие за управление различными системами города.

## Глава 1: ConstructionCompany.cs

`ConstructionCompany` — это **сервисный класс**, отвечающий за логику создания и размещения всех типов зданий в игре.

### Основная логика

- Класс получает в конструкторе экземпляр `PlayerResources`, из которого берет информацию о балансе и материалах игрока.
- Метод `TryBuild<T>` является универсальным строителем для любого здания, наследующего `Building` и `IConstructable<T>`.

### Методы

- **`TryBuild<T>(...)`**: `bool`
  - Проверяет, достаточно ли у игрока денег (`BuildCost`) и материалов (`RequiredMaterials`), которые он получает из статических полей класса `T`.
  - Если все проверки пройдены, вычитает ресурсы из `PlayerResources`, создает экземпляр здания, размещает его на карте и возвращает `true`.

## Глава 2: UtilityService.cs

`UtilityService` — сервис управления одной коммунальной услугой (ЖКХ). Отвечает за подключение зданий к конкретной сети и управление ее состоянием.

### Свойства

- **`ServiceType`**: `UtilityType` - Тип коммунальной услуги (Electricity, Water, Gas, Sewage).
- **`ConnectedBuildings`**: `List<Building>` - Список зданий, подключенных к этой сети.
- **`IsNetworkOperational`**: `bool` - Работает ли сеть (true - работает, false - авария/отключение).

### Методы

- **`ConnectBuilding(Building building)`**: `void` - Подключает здание к сети.
- **`DisconnectBuilding(Building building)`**: `void` - Отключает здание от сети.
- **`SetNetworkState(bool isOperational)`**: `void` - Включает или выключает всю сеть, обновляя состояние всех подключенных зданий.
- **`GetConnectedBuildingsCount()`**: `int` - Возвращает количество подключенных зданий.

## Глава 3: UtilityManager.cs

`UtilityManager` — менеджер для централизованного управления всеми коммунальными услугами города.

### Свойства

- **`UtilityServices`**: `Dictionary<UtilityType, UtilityService>` - Коллекция всех сервисов ЖКХ, создаваемая в конструкторе.

### Методы

- **`ConnectBuildingToAllUtilities(Building building)`**: `void` - Подключает здание ко всем коммунальным услугам одновременно.
- **`DisconnectBuildingFromAllUtilities(Building building)`**: `void` - Отключает здание от всех коммунальных услуг.
- **`GetUtilityStatistics()`**: `void` - Собирает статистику по всем подключенным зданиям.

## Глава 4: ParkManager.cs

`ParkManager` — менеджер для управления парками и пешеходной инфраструктурой города.

### Методы

- **`CreatePark(GameMap map, ...)`**: `void` - Создает парк на указанной территории.
- **`CreateBikeLane(GameMap map, ...)`**: `void` - Создает велодорожку.
- **`GetHappyTilesCount(GameMap map)`**: `int` - Возвращает количество "счастливых" тайлов (с парками или велодорожками).

## Глава 5: MapGeneratorService.cs

`MapGeneratorService` — сервис для генерации игровой карты. *На данный момент является заглушкой и не содержит логики.*

## Глава 6: Взаимодействие систем

### Интеграция ЖКХ с другими модулями

- **Производственные здания**: Требуют электричество для работы оборудования.
- **Жилые здания**: Требуют все коммунальные услуги для комфортного проживания.
- **Общественные здания**: Требуют коммунальные услуги для предоставления услуг.

### Интеграция пешеходной инфраструктуры

- **Система счастья**: Парки и велодорожки увеличивают счастье жителей.
- **Перемещение**: Пешеходные дорожки улучшают маршруты перемещения.
- **Экология**: Зеленые зоны положительно влияют на экологию города.

---